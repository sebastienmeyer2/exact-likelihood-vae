<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>src.utils API documentation</title>
<meta name="description" content="Gather utilitary functions for randomness control and parameters checking." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.utils</code></h1>
</header>
<section id="section-intro">
<p>Gather utilitary functions for randomness control and parameters checking.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;Gather utilitary functions for randomness control and parameters checking.&#34;&#34;&#34;


from typing import Tuple

import argparse

import random
import numpy as np

import torch
from torch.nn import Module
from torch.nn import BCELoss, MSELoss
from torch.optim import Optimizer
from torch.optim import Adam
from torch.utils.data import Dataset

from torchvision.datasets import MNIST
from torchvision.transforms import Compose, ToTensor


from nn import AutoEncoder, VariationalAutoEncoder, VAELoss


def str2bool(v: str) -&gt; bool:
    &#34;&#34;&#34;An easy way to handle boolean options.

    Parameters
    ----------
    v : str
        Argument value.

    Returns
    -------
    str2bool(v) : bool
        Corresponding boolean value, if it exists.

    Raises
    ------
    argparse.ArgumentTypeError
        If the entry cannot be converted to a boolean.
    &#34;&#34;&#34;
    if isinstance(v, bool):
        return v
    if v.lower() in (&#34;yes&#34;, &#34;true&#34;, &#34;t&#34;, &#34;y&#34;, &#34;1&#34;):
        return True
    if v.lower() in (&#34;no&#34;, &#34;false&#34;, &#34;f&#34;, &#34;n&#34;, &#34;0&#34;):
        return False
    raise argparse.ArgumentTypeError(&#34;Boolean value expected.&#34;)


def set_seed(seed: int = 42):
    &#34;&#34;&#34;Fix seed for current run.

    Parameters
    ----------
    seed : int, default=42
        Seed to use everywhere for reproducibility.
    &#34;&#34;&#34;
    random.seed(seed)
    np.random.seed(seed)  # pandas seed is numpy seed
    torch.manual_seed(seed)
    torch.cuda.manual_seed_all(seed)


def init_model(
    model_name: str = &#34;ae&#34;, input_dim: int = 784, hidden_dim: int = 128, encoding_dim: int = 32
) -&gt; Module:
    &#34;&#34;&#34;Initialize a model based on its name.

    Parameters
    ----------
    model_name : {&#34;ae&#34;, &#34;vae&#34;}
        Name of the model following project usage.

    input_dim : int, default=784
        Input dimension.

    hidden_dim : int, default=128
        Hidden dimension.

    encoding_dim : int, default=32
        Encoding dimension.

    Returns
    -------
    model : torch.nn.Module
        An Auto Encoder to be trained and evaluated.

    Raises
    ------
    ValueError
        If the **model_name** is unsupported.
    &#34;&#34;&#34;
    model: Module

    if model_name == &#34;ae&#34;:
        model = AutoEncoder(input_dim=input_dim, hidden_dim=hidden_dim, encoding_dim=encoding_dim)
    elif model_name == &#34;vae&#34;:
        model = VariationalAutoEncoder(
            input_dim=input_dim, hidden_dim=hidden_dim, encoding_dim=encoding_dim
        )
    else:
        err_msg = f&#34;&#34;&#34;Unknown model {model_name}. Choose from: &#34;ae&#34; and &#34;vae&#34;.&#34;&#34;&#34;
        raise ValueError(err_msg)

    return model


def init_criterion(model_name: str = &#34;ae&#34;) -&gt; Module:
    &#34;&#34;&#34;Initialize a loss function based on the considered dataset.

    Parameters
    ----------
    model_name : {&#34;ae&#34;, &#34;vae&#34;}
        Name of the model following project usage.

    Returns
    -------
    criterion : torch.nn.Module
        A loss function. Classical Auto Encoder is associated with the binary cross entropy loss,
        while loss function for Variational Auto Encoder is a combination of binary cross entropy
        and Kullback-Leibler divergence.
    &#34;&#34;&#34;
    criterion: Module

    if model_name == &#34;ae&#34;:
        criterion = BCELoss(reduction=&#34;sum&#34;)
    elif model_name == &#34;vae&#34;:
        criterion = VAELoss()
    else:  # default loss
        criterion = MSELoss(reduction=&#34;sum&#34;)

    return criterion


def init_optim(
    model: Module, optim_name: str = &#34;adam&#34;, lr: float = 1e-3, weight_decay: float = 0.0
) -&gt; Optimizer:
    &#34;&#34;&#34;Initialize an optimizer based on its name.

    Parameters
    ----------
    optim_name : {&#34;adam&#34;}
        Name of the optimizer following project usage.

    lr : float, default=0.001
        Learning rate for the optimizer.

    weight_decay : float, default=0.0
        Weight decay for the optimizer.

    Returns
    -------
    optimizer : torch.optim.Optimizer
        An optimizer to train the model with.
    &#34;&#34;&#34;
    optimizer: Optimizer

    if optim_name == &#34;adam&#34;:
        optimizer = Adam(model.parameters(), lr=lr, weight_decay=weight_decay)
    else:
        err_msg = f&#34;&#34;&#34;Unknown optimizer {optim_name}. Choose from: &#34;adam&#34;.&#34;&#34;&#34;
        raise ValueError(err_msg)

    return optimizer


def init_data(data_dir: str = &#34;data&#34;) -&gt; Tuple[Dataset, Dataset]:
    &#34;&#34;&#34;Initialize MNIST dataset.

    Parameters
    ----------
    data_dir : str, default=&#34;data&#34;
        Data directory.

    Returns
    -------
    train_set : torch.utils.data.Dataset
        The training set.

    test_set : torch.utils.data.Dataset
        The test set.
    &#34;&#34;&#34;
    transform = Compose([
        ToTensor()
    ])

    train_set = MNIST(data_dir, train=True, download=True, transform=transform)
    test_set = MNIST(data_dir, train=False, download=True, transform=transform)

    return train_set, test_set


def convert_name(name: str = &#34;ae&#34;) -&gt; str:
    &#34;&#34;&#34;Convert model or sampling name to header.

    Parameters
    ----------
    name : str, default=&#34;ae&#34;
        Name of the model or sampling.

    Returns
    -------
    header : str
        Corresponding header.
    &#34;&#34;&#34;
    header: str

    if name == &#34;ae&#34;:
        header = &#34;Auto Encoder&#34;
    elif name == &#34;vae&#34;:
        header = &#34;Variational Auto Encoder&#34;
    elif name == &#34;simple&#34;:
        header = &#34;Single pass&#34;
    elif name == &#34;gibbs&#34;:
        header = &#34;Pseudo-Gibbs sampling&#34;
    elif name == &#34;mhwg&#34;:
        header = &#34;Metropolis-Hastings within Gibbs sampling&#34;
    elif name == &#34;ite_tree&#34;:
        header = &#34;Trees Iterative Imputing&#34;
    elif name == &#34;ite_ridge&#34;:
        header = &#34;Ridge Iterative Imputing&#34;
    elif name == &#34;mar&#34;:
        header = &#34;Missing-at-random&#34;
    elif name == &#34;half&#34;:
        header = &#34;Missing upper half&#34;
    else:
        header = name

    return header</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="src.utils.convert_name"><code class="name flex">
<span>def <span class="ident">convert_name</span></span>(<span>name: str = 'ae') ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Convert model or sampling name to header.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code>, default=<code>"ae"</code></dt>
<dd>Name of the model or sampling.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>header</code></strong> :&ensp;<code>str</code></dt>
<dd>Corresponding header.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def convert_name(name: str = &#34;ae&#34;) -&gt; str:
    &#34;&#34;&#34;Convert model or sampling name to header.

    Parameters
    ----------
    name : str, default=&#34;ae&#34;
        Name of the model or sampling.

    Returns
    -------
    header : str
        Corresponding header.
    &#34;&#34;&#34;
    header: str

    if name == &#34;ae&#34;:
        header = &#34;Auto Encoder&#34;
    elif name == &#34;vae&#34;:
        header = &#34;Variational Auto Encoder&#34;
    elif name == &#34;simple&#34;:
        header = &#34;Single pass&#34;
    elif name == &#34;gibbs&#34;:
        header = &#34;Pseudo-Gibbs sampling&#34;
    elif name == &#34;mhwg&#34;:
        header = &#34;Metropolis-Hastings within Gibbs sampling&#34;
    elif name == &#34;ite_tree&#34;:
        header = &#34;Trees Iterative Imputing&#34;
    elif name == &#34;ite_ridge&#34;:
        header = &#34;Ridge Iterative Imputing&#34;
    elif name == &#34;mar&#34;:
        header = &#34;Missing-at-random&#34;
    elif name == &#34;half&#34;:
        header = &#34;Missing upper half&#34;
    else:
        header = name

    return header</code></pre>
</details>
</dd>
<dt id="src.utils.init_criterion"><code class="name flex">
<span>def <span class="ident">init_criterion</span></span>(<span>model_name: str = 'ae') ‑> torch.nn.modules.module.Module</span>
</code></dt>
<dd>
<div class="desc"><p>Initialize a loss function based on the considered dataset.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>model_name</code></strong> :&ensp;<code>{"ae", "vae"}</code></dt>
<dd>Name of the model following project usage.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>criterion</code></strong> :&ensp;<code>torch.nn.Module</code></dt>
<dd>A loss function. Classical Auto Encoder is associated with the binary cross entropy loss,
while loss function for Variational Auto Encoder is a combination of binary cross entropy
and Kullback-Leibler divergence.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_criterion(model_name: str = &#34;ae&#34;) -&gt; Module:
    &#34;&#34;&#34;Initialize a loss function based on the considered dataset.

    Parameters
    ----------
    model_name : {&#34;ae&#34;, &#34;vae&#34;}
        Name of the model following project usage.

    Returns
    -------
    criterion : torch.nn.Module
        A loss function. Classical Auto Encoder is associated with the binary cross entropy loss,
        while loss function for Variational Auto Encoder is a combination of binary cross entropy
        and Kullback-Leibler divergence.
    &#34;&#34;&#34;
    criterion: Module

    if model_name == &#34;ae&#34;:
        criterion = BCELoss(reduction=&#34;sum&#34;)
    elif model_name == &#34;vae&#34;:
        criterion = VAELoss()
    else:  # default loss
        criterion = MSELoss(reduction=&#34;sum&#34;)

    return criterion</code></pre>
</details>
</dd>
<dt id="src.utils.init_data"><code class="name flex">
<span>def <span class="ident">init_data</span></span>(<span>data_dir: str = 'data') ‑> Tuple[torch.utils.data.dataset.Dataset, torch.utils.data.dataset.Dataset]</span>
</code></dt>
<dd>
<div class="desc"><p>Initialize MNIST dataset.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>data_dir</code></strong> :&ensp;<code>str</code>, default=<code>"data"</code></dt>
<dd>Data directory.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>train_set</code></strong> :&ensp;<code>torch.utils.data.Dataset</code></dt>
<dd>The training set.</dd>
<dt><strong><code>test_set</code></strong> :&ensp;<code>torch.utils.data.Dataset</code></dt>
<dd>The test set.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_data(data_dir: str = &#34;data&#34;) -&gt; Tuple[Dataset, Dataset]:
    &#34;&#34;&#34;Initialize MNIST dataset.

    Parameters
    ----------
    data_dir : str, default=&#34;data&#34;
        Data directory.

    Returns
    -------
    train_set : torch.utils.data.Dataset
        The training set.

    test_set : torch.utils.data.Dataset
        The test set.
    &#34;&#34;&#34;
    transform = Compose([
        ToTensor()
    ])

    train_set = MNIST(data_dir, train=True, download=True, transform=transform)
    test_set = MNIST(data_dir, train=False, download=True, transform=transform)

    return train_set, test_set</code></pre>
</details>
</dd>
<dt id="src.utils.init_model"><code class="name flex">
<span>def <span class="ident">init_model</span></span>(<span>model_name: str = 'ae', input_dim: int = 784, hidden_dim: int = 128, encoding_dim: int = 32) ‑> torch.nn.modules.module.Module</span>
</code></dt>
<dd>
<div class="desc"><p>Initialize a model based on its name.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>model_name</code></strong> :&ensp;<code>{"ae", "vae"}</code></dt>
<dd>Name of the model following project usage.</dd>
<dt><strong><code>input_dim</code></strong> :&ensp;<code>int</code>, default=<code>784</code></dt>
<dd>Input dimension.</dd>
<dt><strong><code>hidden_dim</code></strong> :&ensp;<code>int</code>, default=<code>128</code></dt>
<dd>Hidden dimension.</dd>
<dt><strong><code>encoding_dim</code></strong> :&ensp;<code>int</code>, default=<code>32</code></dt>
<dd>Encoding dimension.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>model</code></strong> :&ensp;<code>torch.nn.Module</code></dt>
<dd>An Auto Encoder to be trained and evaluated.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ValueError</code></dt>
<dd>If the <strong>model_name</strong> is unsupported.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_model(
    model_name: str = &#34;ae&#34;, input_dim: int = 784, hidden_dim: int = 128, encoding_dim: int = 32
) -&gt; Module:
    &#34;&#34;&#34;Initialize a model based on its name.

    Parameters
    ----------
    model_name : {&#34;ae&#34;, &#34;vae&#34;}
        Name of the model following project usage.

    input_dim : int, default=784
        Input dimension.

    hidden_dim : int, default=128
        Hidden dimension.

    encoding_dim : int, default=32
        Encoding dimension.

    Returns
    -------
    model : torch.nn.Module
        An Auto Encoder to be trained and evaluated.

    Raises
    ------
    ValueError
        If the **model_name** is unsupported.
    &#34;&#34;&#34;
    model: Module

    if model_name == &#34;ae&#34;:
        model = AutoEncoder(input_dim=input_dim, hidden_dim=hidden_dim, encoding_dim=encoding_dim)
    elif model_name == &#34;vae&#34;:
        model = VariationalAutoEncoder(
            input_dim=input_dim, hidden_dim=hidden_dim, encoding_dim=encoding_dim
        )
    else:
        err_msg = f&#34;&#34;&#34;Unknown model {model_name}. Choose from: &#34;ae&#34; and &#34;vae&#34;.&#34;&#34;&#34;
        raise ValueError(err_msg)

    return model</code></pre>
</details>
</dd>
<dt id="src.utils.init_optim"><code class="name flex">
<span>def <span class="ident">init_optim</span></span>(<span>model: torch.nn.modules.module.Module, optim_name: str = 'adam', lr: float = 0.001, weight_decay: float = 0.0) ‑> torch.optim.optimizer.Optimizer</span>
</code></dt>
<dd>
<div class="desc"><p>Initialize an optimizer based on its name.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>optim_name</code></strong> :&ensp;<code>{"adam"}</code></dt>
<dd>Name of the optimizer following project usage.</dd>
<dt><strong><code>lr</code></strong> :&ensp;<code>float</code>, default=<code>0.001</code></dt>
<dd>Learning rate for the optimizer.</dd>
<dt><strong><code>weight_decay</code></strong> :&ensp;<code>float</code>, default=<code>0.0</code></dt>
<dd>Weight decay for the optimizer.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>optimizer</code></strong> :&ensp;<code>torch.optim.Optimizer</code></dt>
<dd>An optimizer to train the model with.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_optim(
    model: Module, optim_name: str = &#34;adam&#34;, lr: float = 1e-3, weight_decay: float = 0.0
) -&gt; Optimizer:
    &#34;&#34;&#34;Initialize an optimizer based on its name.

    Parameters
    ----------
    optim_name : {&#34;adam&#34;}
        Name of the optimizer following project usage.

    lr : float, default=0.001
        Learning rate for the optimizer.

    weight_decay : float, default=0.0
        Weight decay for the optimizer.

    Returns
    -------
    optimizer : torch.optim.Optimizer
        An optimizer to train the model with.
    &#34;&#34;&#34;
    optimizer: Optimizer

    if optim_name == &#34;adam&#34;:
        optimizer = Adam(model.parameters(), lr=lr, weight_decay=weight_decay)
    else:
        err_msg = f&#34;&#34;&#34;Unknown optimizer {optim_name}. Choose from: &#34;adam&#34;.&#34;&#34;&#34;
        raise ValueError(err_msg)

    return optimizer</code></pre>
</details>
</dd>
<dt id="src.utils.set_seed"><code class="name flex">
<span>def <span class="ident">set_seed</span></span>(<span>seed: int = 42)</span>
</code></dt>
<dd>
<div class="desc"><p>Fix seed for current run.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>seed</code></strong> :&ensp;<code>int</code>, default=<code>42</code></dt>
<dd>Seed to use everywhere for reproducibility.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_seed(seed: int = 42):
    &#34;&#34;&#34;Fix seed for current run.

    Parameters
    ----------
    seed : int, default=42
        Seed to use everywhere for reproducibility.
    &#34;&#34;&#34;
    random.seed(seed)
    np.random.seed(seed)  # pandas seed is numpy seed
    torch.manual_seed(seed)
    torch.cuda.manual_seed_all(seed)</code></pre>
</details>
</dd>
<dt id="src.utils.str2bool"><code class="name flex">
<span>def <span class="ident">str2bool</span></span>(<span>v: str) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>An easy way to handle boolean options.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>v</code></strong> :&ensp;<code>str</code></dt>
<dd>Argument value.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str2bool(v) : bool</code></dt>
<dd>Corresponding boolean value, if it exists.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>argparse.ArgumentTypeError</code></dt>
<dd>If the entry cannot be converted to a boolean.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def str2bool(v: str) -&gt; bool:
    &#34;&#34;&#34;An easy way to handle boolean options.

    Parameters
    ----------
    v : str
        Argument value.

    Returns
    -------
    str2bool(v) : bool
        Corresponding boolean value, if it exists.

    Raises
    ------
    argparse.ArgumentTypeError
        If the entry cannot be converted to a boolean.
    &#34;&#34;&#34;
    if isinstance(v, bool):
        return v
    if v.lower() in (&#34;yes&#34;, &#34;true&#34;, &#34;t&#34;, &#34;y&#34;, &#34;1&#34;):
        return True
    if v.lower() in (&#34;no&#34;, &#34;false&#34;, &#34;f&#34;, &#34;n&#34;, &#34;0&#34;):
        return False
    raise argparse.ArgumentTypeError(&#34;Boolean value expected.&#34;)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src" href="index.html">src</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="src.utils.convert_name" href="#src.utils.convert_name">convert_name</a></code></li>
<li><code><a title="src.utils.init_criterion" href="#src.utils.init_criterion">init_criterion</a></code></li>
<li><code><a title="src.utils.init_data" href="#src.utils.init_data">init_data</a></code></li>
<li><code><a title="src.utils.init_model" href="#src.utils.init_model">init_model</a></code></li>
<li><code><a title="src.utils.init_optim" href="#src.utils.init_optim">init_optim</a></code></li>
<li><code><a title="src.utils.set_seed" href="#src.utils.set_seed">set_seed</a></code></li>
<li><code><a title="src.utils.str2bool" href="#src.utils.str2bool">str2bool</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>